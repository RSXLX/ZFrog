---
status: 已审核
version: 1.0
last_updated: 2026-01-15
reviewer: 用户
---

# 管理员前端需求设计

> 一个独立的管理员控制台，用于统一管理 ZetaFrog 项目的核心功能和智能合约配置。

## 一、背景与目标

### 1.1 背景
当前 ZetaFrog 项目存在以下管理痛点：
1. **合约地址管理混乱**：合约地址分散在多个 `.env` 文件中，手动维护容易出错
2. **缺乏数据管理界面**：青蛙、好友、徽章等数据只能通过数据库直接操作
3. **状态监控困难**：无法直观查看合约状态、链上配置是否正常
4. **部署流程繁琐**：重新部署合约需要手动执行多个脚本并更新配置

### 1.2 目标
开发一个独立的管理员前端，实现：
1. **合约地址统一管理**：集中管理所有合约地址，支持一键更新环境配置
2. **数据可视化管理**：提供青蛙、好友、徽章等核心数据的 CRUD 操作
3. **系统状态监控**：实时展示合约状态、链上配置、服务健康状况
4. **部署辅助工具**：提供合约部署向导和配置验证功能

---

## 二、访问方式

- **无需认证**：独立入口，无需登录注册鉴权
- **独立端口**：运行在单独端口（如 3002）
- **安全建议**：仅在开发环境使用，生产环境建议通过网络隔离或 IP 白名单保护

---

## 三、功能模块

### 3.1 仪表盘 (Dashboard)
**优先级：P0**

| 功能 | 描述 |
|------|------|
| 系统概览 | 展示青蛙总数、旅行次数、徽章解锁数等核心指标 |
| 服务状态 | 后端服务健康状态、数据库连接状态 |
| 链状态 | 各链 RPC 连通性、当前区块高度 |
| 合约状态 | 各合约部署状态、版本信息 |

### 3.2 合约管理 (Contract Management)
**优先级：P0**

| 功能 | 描述 |
|------|------|
| 合约地址总览 | 展示所有合约地址（ZetaFrogNFT、OmniTravel、Travel、Souvenir、Connector 等） |
| 链上状态验证 | 验证合约是否正确部署、权限是否正确配置 |
| 配置同步 | 更新 backend/.env 和 frontend/.env 中的合约地址 |
| 部署历史 | 查看历史部署记录 |
| 一键配置 | 执行 `configure-all-travel.js`、`configure-omnitravel-proxy.js` 等配置脚本 |

**链上状态检查项**：
- `ZetaFrogNFT.omniTravelContract` 是否正确设置
- `ZetaFrogNFT.travelContract` 是否正确设置
- `OmniTravel.supportedChains[97]` 和 `supportedChains[11155111]` 是否为 true
- `OmniTravel.testMode` 状态
- 各 Connector 与 OmniTravel 的关联是否正确

### 3.3 青蛙管理 (Frog Management)
**优先级：P1**

| 功能 | 描述 |
|------|------|
| 青蛙列表 | 分页展示所有青蛙，支持按 tokenId、owner 搜索 |
| 青蛙详情 | 查看青蛙完整信息（状态、XP、等级、旅行统计等） |
| 状态修改 | 修改青蛙状态（如重置卡住的 Traveling 状态） |
| 批量操作 | 批量同步链上数据 |

**注意**：tokenId、ownerAddress 等链上数据不可修改

### 3.4 好友管理 (Friend Management)
**优先级：P2**

| 功能 | 描述 |
|------|------|
| 好友关系列表 | 查看所有好友关系，支持按状态筛选 |
| 关系详情 | 查看好友关系详情（友情等级、互动记录） |
| 关系清理 | 删除无效/测试数据 |

### 3.5 徽章管理 (Badge Management)
**优先级：P1**

| 功能 | 描述 |
|------|------|
| 徽章定义管理 | 添加、编辑、软删除徽章定义 (TravelBadge) |
| 徽章解锁记录 | 查看用户徽章解锁记录 (UserBadge) |
| 空投配置 | 配置徽章解锁的空投奖励金额 |

### 3.6 旅行管理 (Travel Management)
**优先级：P2**

| 功能 | 描述 |
|------|------|
| 旅行记录列表 | 分页查看所有旅行记录 |
| 旅行详情 | 查看旅行详情（跨链状态、发现内容） |
| 异常处理 | 处理卡住的旅行（强制完成/取消） |

### 3.7 系统配置 (System Config)
**优先级：P1**

| 功能 | 描述 |
|------|------|
| 环境变量管理 | 查看/更新 backend 和 frontend 的环境变量 |
| RPC 配置 | 管理各链的 RPC URL |
| 管理员密钥 | 安全管理发放者私钥（仅展示部分，支持更新） |

---

## 四、用户场景

### 场景 1：查看系统状态
1. 管理员登录管理后台
2. 在仪表盘查看服务健康状态
3. 检查各链 RPC 连通性
4. 查看合约部署状态

### 场景 2：重新部署合约后更新配置
1. 管理员在命令行执行合约部署脚本
2. 在合约管理页面输入新的合约地址
3. 点击"验证"按钮检查链上状态
4. 验证通过后点击"同步配置"更新环境变量
5. 重启后端和前端服务

### 场景 3：处理卡住的青蛙
1. 用户反馈青蛙状态卡住
2. 管理员在青蛙管理页面搜索该青蛙
3. 查看青蛙状态和关联的旅行记录
4. 确认链上状态后，重置青蛙状态为 Idle

### 场景 4：添加新徽章
1. 管理员进入徽章管理页面
2. 点击"添加徽章"
3. 填写徽章信息（名称、描述、解锁条件、空投金额）
4. 保存后徽章生效

---

## 五、非功能性需求

### 5.1 安全性
- 敏感操作需要二次确认（如删除数据、修改配置）
- 私钥等敏感信息不完整展示（仅显示首尾字符）
- 生产环境建议通过网络隔离或 IP 白名单保护

### 5.2 可用性
- 响应式设计，支持主流浏览器
- 操作反馈及时（加载状态、成功/失败提示）

### 5.3 部署
- 独立部署在不同端口（如 3002）
- 可通过 Nginx 配置 `/admin` 路径访问

---

## 六、技术约束

### 6.1 技术栈
- **前端框架**：React + TypeScript（与主前端保持一致）
- **UI 组件**：Ant Design（适合后台管理系统）
- **状态管理**：Zustand
- **构建工具**：Vite

### 6.2 后端接口
复用现有后端服务，新增 `/api/admin/*` 路由前缀：
- `GET /api/admin/dashboard` - 获取仪表盘数据
- `GET/POST /api/admin/contracts` - 合约管理
- `GET/PUT /api/admin/frogs` - 青蛙管理
- `GET/DELETE /api/admin/friends` - 好友管理
- `GET/POST/PUT/DELETE /api/admin/badges` - 徽章管理
- `GET/PUT /api/admin/config` - 配置管理

### 6.3 目录结构
```
FROG/
├── admin/                    # 新建管理员前端
│   ├── src/
│   │   ├── components/       # 通用组件
│   │   ├── pages/           # 页面组件
│   │   ├── services/        # API 服务
│   │   ├── stores/          # 状态管理
│   │   └── utils/           # 工具函数
│   ├── package.json
│   └── vite.config.ts
├── backend/
│   └── src/
│       └── api/
│           └── routes/
│               └── admin.routes.ts  # 新增管理员 API
```

---

## 七、假设与澄清

| 假设 | 说明 |
|------|------|
| 无需认证 | 独立入口，无登录注册鉴权 |
| 配置文件更新 | 通过后端接口更新 .env 文件 |
| 合约部署 | 合约部署仍在命令行执行，管理后台仅更新地址 |

---

## 八、未来扩展（待定）

- 用户管理（封禁、查询用户行为）
- 日志查看（后端日志、错误日志）
- 数据统计报表（旅行趋势、活跃用户等）
- 合约直接部署（集成 Hardhat 部署脚本）

---

## 变更记录

| 日期 | 变更内容 |
|------|----------|
| 2026-01-15 | 初始化需求设计文档 |
