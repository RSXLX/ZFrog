---
status: 已审核
version: 1.0
last_updated: 2026-01-13
reviewer: AI
---

# 旅行系统模块需求设计

## 一、模块概述

旅行系统是 ZetaFrog 的核心玩法，允许青蛙进行本地旅行和跨链旅行，获得奖励和纪念品。

## 二、用户场景

### 2.1 发起旅行
- 选择旅行类型（本地/跨链）
- 选择目的地（跨链时选择目标链）
- 消耗物资准备旅行
- 确认交易发起旅行

### 2.2 旅行进行中
- 查看青蛙旅行状态和位置
- 查看预计返回时间
- 随机探索事件

### 2.3 旅行结束
- 领取旅行奖励（XP、物资）
- 获得旅行日记
- 可能获得纪念品 NFT
- 解锁成就徽章

## 三、功能需求

### 3.1 旅行合约功能
| 功能 | 描述 |
|------|------|
| startTravel | 开始本地旅行 |
| completeTravel | 完成旅行 |
| OmniTravel | 跨链旅行合约 |

### 3.2 后端功能
| 功能 | 描述 |
|------|------|
| 旅行调度 | 计划旅行时间和路线 |
| 事件生成 | 生成随机探索事件 |
| 日记生成 | AI 生成旅行日记 |
| 奖励计算 | 计算旅行获得的奖励 |

### 3.3 前端功能
| 功能 | 描述 |
|------|------|
| 旅行发起 | 选择目的地和配置 |
| 状态展示 | 实时显示旅行进度 |
| 日记查看 | 展示生成的旅行日记 |

## 四、数据结构

```typescript
interface Travel {
  id: string;
  tokenId: number;
  type: 'local' | 'cross-chain';
  destination: string;
  status: 'pending' | 'traveling' | 'completed';
  startedAt: Date;
  completedAt?: Date;
  rewards: TravelRewards;
  journal?: TravelJournal;
}
```

## 五、接口依赖

- 后端路由：`travel.routes.ts`、`cross-chain.routes.ts`
- 服务：`travel.service.ts`、`omni-travel.service.ts`
- 合约：`Travel.sol`、`OmniTravel.sol`
- 前端组件：`components/travel/`

## 六、边界条件

- 同一时间只能有一只青蛙在旅行
- 跨链旅行需要足够的跨链 gas
- 旅行中途不可取消
- 链上交易失败的回滚处理

---
